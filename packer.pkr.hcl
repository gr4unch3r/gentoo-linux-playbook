
source "virtualbox-iso" "autogenerated_1" {
  boot_command         = ["rc-service sshd start", "echo 'root:L4rry_Th3_C0w' | chpasswd"]
  communicator         = "ssh"
  disk_size            = 40960
  guest_additions_mode = "disable"
  guest_os_type        = "Gentoo_64"
  headless             = true
  iso_checksum         = "file:https://distfiles.gentoo.org/releases/amd64/autobuilds/20220508T170538Z/install-amd64-minimal-20220508T170538Z.iso.DIGESTS"
  iso_url              = "https://distfiles.gentoo.org/releases/amd64/autobuilds/20220508T170538Z/install-amd64-minimal-20220508T170538Z.iso"
  memory               = 8192
  shutdown_command     = "shutdown -hP now"
  ssh_host             = "livecd"
  ssh_password         = "L4rry_Th3_C0w"
  ssh_username         = "root"
  vm_name              = "Gentoo"
}

build {
  sources = ["source.virtualbox-iso.autogenerated_1"]

  provisioner "ansible" {
    galaxy_file   = "requirements.yml"
    playbook_file = "main.yml"
  }

  post-processor "manifest" {
    output     = "manifest.json"
    strip_path = true
  }
  post-processor "artifice" {
    keep_input_artifact = false
  }
}
